# Security settings for uploads directory
# Apache 2.4+

# Disable script execution
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi)$">
    Require all denied
</FilesMatch>

# Only allow image files
<FilesMatch "\.(jpg|jpeg|png|gif|webp)$">
    Require all granted
</FilesMatch>

# Disable directory listing
Options -Indexes

# Prevent access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Set proper MIME types for images
<IfModule mod_mime.c>
    AddType image/jpeg jpg jpeg
    AddType image/png png
    AddType image/gif gif
    AddType image/webp webp
</IfModule>

# Prevent hotlinking (optional - uncomment and adjust domain)
# RewriteEngine on
# RewriteCond %{HTTP_REFERER} !^$
# RewriteCond %{HTTP_REFERER} !^https://(www\.)?yourdomain\.com(/.*)?$ [NC]
# RewriteRule \.(jpg|jpeg|png|gif|webp)$ - [F,L]
